function Items:AddDropdown(DropdownConfig)
    local DropdownConfig = DropdownConfig or {}
    DropdownConfig.Title = DropdownConfig.Title or "Title"
    DropdownConfig.Content = DropdownConfig.Content or ""
    DropdownConfig.Multi = DropdownConfig.Multi or false
    DropdownConfig.Options = DropdownConfig.Options or {}
    DropdownConfig.Default = DropdownConfig.Default or (DropdownConfig.Multi and {} or nil)
    DropdownConfig.Callback = DropdownConfig.Callback or function() end

    local configKey = "Dropdown_" .. DropdownConfig.Title
    if ConfigData[configKey] ~= nil then
        DropdownConfig.Default = ConfigData[configKey]
    end

    local DropdownFunc = { Value = DropdownConfig.Default, Options = DropdownConfig.Options }
    local isOpen = false

    -- Wrapper pakai AutomaticSize Y, ngikut konten otomatis
    local Wrapper = Instance.new("Frame")
    Wrapper.BackgroundTransparency = 1
    Wrapper.BorderSizePixel = 0
    Wrapper.LayoutOrder = CountItem
    Wrapper.Size = UDim2.new(1, 0, 0, 0)
    Wrapper.AutomaticSize = Enum.AutomaticSize.Y
    Wrapper.Name = "Dropdown"
    Wrapper.Parent = SectionAdd

    local WrapperLayout = Instance.new("UIListLayout")
    WrapperLayout.Padding = UDim.new(0, 0)
    WrapperLayout.SortOrder = Enum.SortOrder.LayoutOrder
    WrapperLayout.Parent = Wrapper

    -- Header row
    local Header = Instance.new("Frame")
    Header.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Header.BackgroundTransparency = 0.935
    Header.BorderSizePixel = 0
    Header.LayoutOrder = 0
    Header.Size = UDim2.new(1, 0, 0, 40)
    Header.ZIndex = 2
    Header.Parent = Wrapper
    Instance.new("UICorner", Header).CornerRadius = UDim.new(0, 4)

    -- Title kiri "Select X: [value]"
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.Text = DropdownConfig.Title .. ": None"
    TitleLabel.TextColor3 = Color3.fromRGB(210, 210, 210)
    TitleLabel.TextSize = 12
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.TextTruncate = Enum.TextTruncate.AtEnd
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Position = UDim2.new(0, 10, 0, 0)
    TitleLabel.Size = UDim2.new(1, -220, 1, 0)
    TitleLabel.ZIndex = 3
    TitleLabel.Name = "TitleLabel"
    TitleLabel.Parent = Header

    -- Search box di kanan
    local SearchBox = Instance.new("TextBox")
    SearchBox.PlaceholderText = "Search..."
    SearchBox.PlaceholderColor3 = Color3.fromRGB(100, 100, 100)
    SearchBox.Font = Enum.Font.Gotham
    SearchBox.Text = ""
    SearchBox.TextSize = 11
    SearchBox.TextColor3 = Color3.fromRGB(200, 200, 200)
    SearchBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    SearchBox.BackgroundTransparency = 0.92
    SearchBox.BorderSizePixel = 0
    SearchBox.AnchorPoint = Vector2.new(1, 0.5)
    SearchBox.Position = UDim2.new(1, -42, 0.5, 0)
    SearchBox.Size = UDim2.new(0, 130, 0, 26)
    SearchBox.ClearTextOnFocus = false
    SearchBox.ZIndex = 3
    SearchBox.Name = "SearchBox"
    SearchBox.Parent = Header
    Instance.new("UICorner", SearchBox).CornerRadius = UDim.new(0, 4)

    -- Arrow button
    local ArrowBtn = Instance.new("TextButton")
    ArrowBtn.Text = "▾"
    ArrowBtn.Font = Enum.Font.GothamBold
    ArrowBtn.TextSize = 16
    ArrowBtn.TextColor3 = Color3.fromRGB(180, 180, 180)
    ArrowBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    ArrowBtn.BackgroundTransparency = 0.92
    ArrowBtn.BorderSizePixel = 0
    ArrowBtn.AnchorPoint = Vector2.new(1, 0.5)
    ArrowBtn.Position = UDim2.new(1, -6, 0.5, 0)
    ArrowBtn.Size = UDim2.new(0, 30, 0, 26)
    ArrowBtn.ZIndex = 3
    ArrowBtn.Name = "ArrowBtn"
    ArrowBtn.Parent = Header
    Instance.new("UICorner", ArrowBtn).CornerRadius = UDim.new(0, 4)

    -- List frame — visible/invisible toggle, NO tween resize
    local ListFrame = Instance.new("Frame")
    ListFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    ListFrame.BackgroundTransparency = 0.95
    ListFrame.BorderSizePixel = 0
    ListFrame.LayoutOrder = 1
    ListFrame.Size = UDim2.new(1, 0, 0, 160)
    ListFrame.ClipsDescendants = true
    ListFrame.Visible = false
    ListFrame.Name = "ListFrame"
    ListFrame.Parent = Wrapper

    local BotCorner = Instance.new("UICorner")
    BotCorner.CornerRadius = UDim.new(0, 4)
    BotCorner.Parent = ListFrame

    -- ScrollingFrame di dalam ListFrame
    local ScrollSelect = Instance.new("ScrollingFrame")
    ScrollSelect.BackgroundTransparency = 1
    ScrollSelect.BorderSizePixel = 0
    ScrollSelect.ScrollBarThickness = 3
    ScrollSelect.ScrollBarImageColor3 = GuiConfig.Color
    ScrollSelect.ScrollBarImageTransparency = 0.4
    ScrollSelect.CanvasSize = UDim2.new(0, 0, 0, 0)
    ScrollSelect.ClipsDescendants = true
    ScrollSelect.Size = UDim2.new(1, -6, 1, 0)
    ScrollSelect.Position = UDim2.new(0, 3, 0, 0)
    ScrollSelect.ZIndex = 3
    ScrollSelect.Name = "ScrollSelect"
    ScrollSelect.Parent = ListFrame

    local UIListLayout = Instance.new("UIListLayout")
    UIListLayout.Padding = UDim.new(0, 0)
    UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    UIListLayout.Parent = ScrollSelect

    UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        ScrollSelect.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y)
    end)

    -- Toggle
    local function toggleOpen()
        isOpen = not isOpen
        ListFrame.Visible = isOpen
        ArrowBtn.Text = isOpen and "▴" or "▾"
        if not isOpen then
            SearchBox.Text = ""
        end
    end

    ArrowBtn.Activated:Connect(toggleOpen)

    -- Klik header juga toggle (selain area search)
    local HeaderBtn = Instance.new("TextButton")
    HeaderBtn.Text = ""
    HeaderBtn.BackgroundTransparency = 1
    HeaderBtn.Size = UDim2.new(1, -180, 1, 0)
    HeaderBtn.ZIndex = 2
    HeaderBtn.Parent = Header
    HeaderBtn.Activated:Connect(toggleOpen)

    -- Search filter
    SearchBox:GetPropertyChangedSignal("Text"):Connect(function()
        local query = string.lower(SearchBox.Text)
        for _, opt in ipairs(ScrollSelect:GetChildren()) do
            if opt:IsA("Frame") and opt.Name == "Option" and opt:FindFirstChild("OptionText") then
                opt.Visible = query == "" or string.find(string.lower(opt.OptionText.Text), query, 1, true) ~= nil
            end
        end
        ScrollSelect.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y)
    end)

    -- Methods
    function DropdownFunc:Clear()
        for _, f in ipairs(ScrollSelect:GetChildren()) do
            if f:IsA("Frame") and f.Name == "Option" then f:Destroy() end
        end
        DropdownFunc.Value = DropdownConfig.Multi and {} or nil
        DropdownFunc.Options = {}
        TitleLabel.Text = DropdownConfig.Title .. ": None"
    end

    function DropdownFunc:AddOption(option)
        local label, value
        if typeof(option) == "table" and option.Label and option.Value ~= nil then
            label = tostring(option.Label)
            value = option.Value
        else
            label = tostring(option)
            value = option
        end

        local Option = Instance.new("Frame")
        Option.BackgroundTransparency = 1
        Option.BorderSizePixel = 0
        Option.Size = UDim2.new(1, 0, 0, 36)
        Option.Name = "Option"
        Option.ZIndex = 4
        Option.Parent = ScrollSelect

        local OptionButton = Instance.new("TextButton")
        OptionButton.BackgroundTransparency = 1
        OptionButton.Size = UDim2.new(1, 0, 1, 0)
        OptionButton.Text = ""
        OptionButton.ZIndex = 5
        OptionButton.Parent = Option

        local OptionText = Instance.new("TextLabel")
        OptionText.Font = Enum.Font.GothamBold
        OptionText.Text = label
        OptionText.TextSize = 12
        OptionText.TextColor3 = Color3.fromRGB(200, 200, 200)
        OptionText.AnchorPoint = Vector2.new(0.5, 0.5)
        OptionText.Position = UDim2.new(0.5, 0, 0.5, 0)
        OptionText.Size = UDim2.new(1, -20, 1, 0)
        OptionText.BackgroundTransparency = 1
        OptionText.TextXAlignment = Enum.TextXAlignment.Center
        OptionText.ZIndex = 5
        OptionText.Name = "OptionText"
        OptionText.Parent = Option

        Option:SetAttribute("RealValue", value)

        -- Hover
        OptionButton.MouseEnter:Connect(function()
            local v = Option:GetAttribute("RealValue")
            local sel = DropdownConfig.Multi
                and table.find(DropdownFunc.Value or {}, v) ~= nil
                or DropdownFunc.Value == v
            if not sel then
                OptionText.TextColor3 = Color3.fromRGB(255, 255, 255)
            end
        end)
        OptionButton.MouseLeave:Connect(function()
            local v = Option:GetAttribute("RealValue")
            local sel = DropdownConfig.Multi
                and table.find(DropdownFunc.Value or {}, v) ~= nil
                or DropdownFunc.Value == v
            OptionText.TextColor3 = sel and GuiConfig.Color or Color3.fromRGB(200, 200, 200)
        end)

        OptionButton.Activated:Connect(function()
            if DropdownConfig.Multi then
                if not table.find(DropdownFunc.Value, value) then
                    table.insert(DropdownFunc.Value, value)
                else
                    for i, v in pairs(DropdownFunc.Value) do
                        if v == value then
                            table.remove(DropdownFunc.Value, i)
                            break
                        end
                    end
                end
            else
                DropdownFunc.Value = value
                isOpen = false
                ListFrame.Visible = false
                ArrowBtn.Text = "▾"
            end
            DropdownFunc:Set(DropdownFunc.Value)
        end)
    end

    function DropdownFunc:Set(Value)
        if DropdownConfig.Multi then
            DropdownFunc.Value = type(Value) == "table" and Value or {}
        else
            DropdownFunc.Value = (type(Value) == "table" and Value[1]) or Value
        end

        ConfigData[configKey] = DropdownFunc.Value

        local texts = {}
        for _, Drop in ipairs(ScrollSelect:GetChildren()) do
            if Drop:IsA("Frame") and Drop.Name == "Option" and Drop:FindFirstChild("OptionText") then
                local v = Drop:GetAttribute("RealValue")
                local selected = DropdownConfig.Multi
                    and table.find(DropdownFunc.Value, v) ~= nil
                    or DropdownFunc.Value == v

                if selected then
                    Drop.OptionText.TextColor3 = GuiConfig.Color
                    table.insert(texts, Drop.OptionText.Text)
                else
                    Drop.OptionText.TextColor3 = Color3.fromRGB(200, 200, 200)
                end
            end
        end

        -- Update title
        if #texts == 0 then
            TitleLabel.Text = DropdownConfig.Title .. ": None"
            TitleLabel.TextColor3 = Color3.fromRGB(210, 210, 210)
        else
            TitleLabel.Text = DropdownConfig.Title .. ": " .. table.concat(texts, ", ")
            TitleLabel.TextColor3 = Color3.fromRGB(210, 210, 210)
        end

        if DropdownConfig.Callback then
            if DropdownConfig.Multi then
                DropdownConfig.Callback(DropdownFunc.Value)
            else
                local str = (DropdownFunc.Value ~= nil) and tostring(DropdownFunc.Value) or ""
                DropdownConfig.Callback(str)
            end
        end
    end

    function DropdownFunc:SetValue(val) self:Set(val) end
    function DropdownFunc:GetValue() return self.Value end

    function DropdownFunc:SetValues(newList, selecting)
        newList = newList or {}
        selecting = selecting or (DropdownConfig.Multi and {} or nil)
        DropdownFunc:Clear()
        for _, v in ipairs(newList) do
            DropdownFunc:AddOption(v)
        end
        DropdownFunc.Options = newList
        DropdownFunc:Set(selecting)
    end

    DropdownFunc:SetValues(DropdownFunc.Options, DropdownFunc.Value)

    CountItem = CountItem + 1
    CountDropdown = CountDropdown + 1
    DropdownFunc.Type = "Dropdown"
    Elements[configKey] = DropdownFunc
    return DropdownFunc
end
